<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE CLISH_MODULE [
<!ENTITY NAME_SPACE                     "http://www.dellemc.com/networking/os10/dell-system">
<!ENTITY NAME_SPACE_NACM                "urn:ietf:params:xml:ns:yang:ietf-netconf-acm">
<!ENTITY SUBTREE_FILTER                 "Filter_Type:SUBTREE;">
<!ENTITY SYSTEM_STATUS                  "/system-state/system-status">
<!ENTITY SYSTEM_ACTIVE_USERS            "/system-state/active-users">
<!ENTITY USERS                          "/system/user">
<!ENTITY USER_NAME                      "/system/user/name">
<!ENTITY USER_PASSWD                    "/system/user/password">
<!ENTITY USER_GROUP                     "/system/user/group">
<!ENTITY USER_KEY                       "/system/user/key">
<!ENTITY NACM_GROUP                     "/groups/group/name">
<!ENTITY NACM_GROUP_USER                "/groups/group/name/user-name">
<!ENTITY USER_ENC                       "/system/user/encryption">
<!ENTITY AAA_AUTH                       "/aaa/authentication/user-authentication-order">
<!ENTITY AAA                            "/aaa/authentication">
<!ENTITY SYSTEM_USER_FILTER             "Filter_Type:SUBTREE;Filter_Namespace:&NAME_SPACE;;Filter_Conditions:">
]>
<CLISH_MODULE xmlns="http://www.dellemc.com/force10/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xi="http://www.w3.org/2001/XInclude" xsi:schemaLocation="http://www.dellemc.com/force10/XMLSchema http://www.dellemc.com/force10/XMLSchema/clish.xsd">
    <!--=======================================================-->
    <!--                Config MODE                            -->
    <!--=======================================================-->
    <VIEW
        name="configure-view"
        >
        <!-- user -->
        <COMMAND
            name="username"
            help="Create or modify users"
            operation="edit-config"
            namespace="&NAME_SPACE;"
            default_oper="merge"
            yang_key="&USER_NAME;"
            >
            <PARAM
                name="sys-user"
                help="User name"
                ptype="STRING"
                yang_name="&USER_NAME;=${sys-user}"
                >
                <PARAM
                    name="password"
                    help="The user password string"
                    ptype="SUBCOMMAND"
                    mode="subcommand">
                    <PARAM
                        name="password-switch"
                        help="The user password string"
                        ptype="SUBCOMMAND"
                        mode="switch">
                        <PARAM
                            name="key"
                            help="Encryption type"
                            db_flag="SKIP_TREE"
                            ptype="SUBCOMMAND"
                            mode="subcommand">
                            <PARAM
                                name="encryption-type"
                                help="Enter the encryption type"
                                ptype="ENCRYPTION_TYPE"
                                yang_name="&USER_KEY;=${encryption-type}">
                                <PARAM
                                    name="clear-password"
                                    help="Enter the clear text password"
                                    ptype="STRING"
                                    yang_name="&USER_PASSWD;=${clear-password}">
                                    <PARAM
                                        name="role"
                                        help="Role which the user is assigned to"
                                        ptype="SUBCOMMAND"
                                        mode="subcommand">
                                        <PARAM
                                            name="role-type"
                                            help="Enter the role type"
                                            ptype="ROLE_TYPE"
                                            prompt_fn="encrypt_password"
                                            prompt_oper="&USER_NAME;=${sys-user},&USER_GROUP;=${role-type},&USER_KEY;=${encryption-type},&USER_PASSWD;=${clear-password}"
                                            yang_name="&USER_GROUP;=${role-type}">
                                        </PARAM>
                                    </PARAM>
                                </PARAM>
                            </PARAM>
                        </PARAM>
                        <PARAM
                            name="sys-passwd"
                            help="Password format (clear text,MD5,SHA256,SHA512):&#xA;&#009;&#009;&#032;&#032;&#032;$0$&lt;clear text password&gt;&#xA;&#009;&#009;&#032;&#032;&#032;$&lt;id&gt;$&lt;salt&gt;$&lt;password hash&gt;"
                            ptype="PASSWORD_STR"
                            yang_name="&USER_PASSWD;=${sys-passwd}">
                            <PARAM
                                name="role"
                                help="Role which the user is assigned to"
                                ptype="SUBCOMMAND"
                                optional="true"
                                mode="subcommand">
                                <PARAM
                                    name="role-type"
                                    help="Enter the role type"
                                    ptype="ROLE_TYPE"
                                    yang_name="&USER_GROUP;=${role-type}">
                                </PARAM>
                            </PARAM>
                        </PARAM>
                   </PARAM>
                </PARAM>
              </PARAM>
            <ACTION
                builtin="clish_extn"
            />
        </COMMAND>
        <!-- no username -->
        <COMMAND
            name="no username"
            operation="edit-config"
            namespace="&NAME_SPACE;"
            help="Delete user"
            sub_oper_yang="remove:user"
            >
            <PARAM
                name="sys-user"
                help="User name"
                ptype="STRING"
                yang_name="&USER_NAME;=${sys-user}"
                >
            </PARAM>
            <ACTION
                builtin="clish_extn"
            />
        </COMMAND>



<!-- ==================================================-->

<COMMAND
    name="aaa"
    operation="edit-config"
    namespace="&NAME_SPACE;"
    help="To configure AAA"
    default_oper="merge"
    >
    <PARAM
        name="authentication"
        ptype="SUBCOMMAND"
        help="To configure AAA authentication"
        mode="subcommand"
        >
        <PARAM
            name="aaa-switch"
            mode="switch"
            help="Configure"
            ptype="SUBCOMMAND"
            sub_oper_yang="replace:authentication"
            >
            <PARAM
                name="local"
                help="Use local authentication"
                ptype="SUBCOMMAND"
                mode="subcommand"
                yang_name= "&AAA_AUTH;=${local}"
                db_flag = "NON_KEYWORD"
		>
                <PARAM
                    name="switch-1"
                    help="Use radius/ldap authentication"
                    ptype="SUBCOMMAND"
                    mode="switch"
                    optional="true"
                    db_flag="SKIP_TREE"
		    >
                    <PARAM
                        name="radius"
                        help="Use radius authentication"
                        ptype="SUBCOMMAND"
                        mode="subcommand"
                        yang_name="&AAA_AUTH;=${radius}"
                        >
                    </PARAM>
                </PARAM>
            </PARAM>
            <PARAM
                name="radius"
                help="Use radius authentication"
                mode="subcommand"
                ptype="SUBCOMMAND"
                db_flag="SKIP_TREE"
                yang_name= "&AAA_AUTH;=${radius}"
                >
                <PARAM
                    name="switch-2"
                    help="Use local/ldap authentication"
                    ptype="SUBCOMMAND"
                    mode="switch"
                    optional="true"
                    >
                    <PARAM
                        name="local"
                        help="Use local authentication"
                        mode="subcommand"
                        ptype="SUBCOMMAND"
                        yang_name="&AAA_AUTH;=${local}"
                        >
                    </PARAM>
                </PARAM>
            </PARAM>
        </PARAM>
    </PARAM>
    <ACTION builtin="clish_extn">
    </ACTION>
</COMMAND>
</VIEW>


    <!--=======================================================-->
    <VIEW name="enable-view">

    <!--show candidate-configuration users -->
      <COMMAND
        name="show candidate-configuration users"
        help="Current candidate users configuration"
        yang_filter="&SUBTREE_FILTER;Filter_Conditions:&USERS;;Filter_Namespace:&NAME_SPACE;"
        db_mode="configure"
        >
        <ACTION builtin="clish_extn"> </ACTION>
      </COMMAND>

    <!--show running-configuration users -->
      <COMMAND
        name="show running-configuration users"
        help="Current operating users configuration"
        yang_filter="&SUBTREE_FILTER;Filter_Conditions:&USERS;;Filter_Namespace:&NAME_SPACE;"
        db_mode="configure"
        >
        <ACTION builtin="clish_extn"> </ACTION>
      </COMMAND>
    <!--show candidate-configuration AAA -->
      <COMMAND
        name="show candidate-configuration aaa"
        help="Current candidate aaa configuration"
        yang_filter="&SUBTREE_FILTER;Filter_Conditions:&AAA;;Filter_Namespace:&NAME_SPACE;"
        db_mode="configure"
        >
        <ACTION builtin="clish_extn"> </ACTION>
      </COMMAND>

    <!--show running-configuration AAA -->
      <COMMAND
        name="show running-configuration aaa"
        help="Current operating aaa configuration"
        yang_filter="&SUBTREE_FILTER;Filter_Conditions:&AAA;;Filter_Namespace:&NAME_SPACE;"
        db_mode="configure"
        >
        <ACTION builtin="clish_extn"> </ACTION>
      </COMMAND>


    <!-- show commands -->
      <COMMAND
        name="show users"
        help="Show the current list of users logged into the system , and show the session id"
        operation="get"
        template_param="curr_sessid= __ncsessionid"
        yang_filter="&SYSTEM_USER_FILTER;/system-state/active-users|Filter_Type:SUBTREE;Filter_Conditions:/netconf-state/sessions,/netconf-state/datastores;Filter_Namespace:urn:ietf:params:xml:ns:yang:ietf-netconf-monitoring"
        template="show_users.xsl"
        >
        <ACTION builtin="clish_extn"> </ACTION>
	<xi:include href="include/pipe.xml"/>
      </COMMAND>
    </VIEW>
</CLISH_MODULE>

