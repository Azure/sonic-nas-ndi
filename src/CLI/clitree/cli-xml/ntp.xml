<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE CLISH_MODULE [
<!ENTITY NAME_SPACE                     "http://www.dellemc.com/networking/os10/dell-ntp">
<!ENTITY MODULE-NS-IETF-INTF "urn:ietf:params:xml:ns:yang:ietf-interfaces">
<!ENTITY MODULE-DELL-NTP "dell-ntp">
<!ENTITY MODULE-INTF-NTP-NS "&MODULE-NS-IETF-INTF;,&MODULE-DELL-NTP;=&NAME_SPACE;">
<!ENTITY SUBTREE_FILTER                 "Filter_Type:SUBTREE">
<!ENTITY NTP_CONFIG                    "/ntp-config">
<!ENTITY INTF_ENTRY        "/interfaces/interface">
<!ENTITY INTF_NAME         "&INTF_ENTRY;/name=${ifacename}">
]>
<CLISH_MODULE
    xmlns="http://www.dellemc.com/force10/XMLSchema"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xmlns:xi="http://www.w3.org/2001/XInclude"
    xsi:schemaLocation="http://www.dellemc.com/force10/XMLSchema
                        http://www.dellemc.com/force10/XMLSchema/clish.xsd"
    >

    <!--=================================================================-->
    <!-- ********************************************************************** -->
    <!-- *  CONFIGURATION COMMANDS                                            * -->
    <!-- *  View : configure-view                                             * -->
    <!-- ********************************************************************** -->

    <VIEW
        name="configure-view"
        >
        <COMMAND
            name="ntp"
            help="Configure NTP"
            operation="edit-config"
            namespace="&NAME_SPACE;"
            >
            <PARAM
                name="ntp Options"
                help="Choose one option"
                ptype="SUBCOMMAND"
                mode="switch"
                >
                <PARAM
                    name="authenticate"
                    help="Authenticate time sources"
                    ptype="SUBCOMMAND"
                    mode="subcommand"
                    yang_name="&NTP_CONFIG;/auth-enabled=true"
                    >
                </PARAM>
                <PARAM
                    name="authentication-key"
                    help="Authentication key for trusted time sources"
                    ptype="SUBCOMMAND"
                    mode="subcommand"
                    yang_key="&NTP_CONFIG;/authentication-keys/authentication-key/key-id"
                    >
                    <PARAM
                        name="pkey_num"
                        help="Key number"
                        ptype="RANGE_1_4294967295"
                        yang_name="&NTP_CONFIG;/authentication-keys/authentication-key/key-id=${pkey_num}"
                        >
                        <PARAM
                            name="md5"
                            help="MD5 authentication"
                            ptype="SUBCOMMAND"
                            mode="subcommand"
                            >
                            <PARAM
                                name="encrypt_opt"
                                help="Specifies an UNENCRYPTED authentication-key string will follow"
                                ptype="SUBCOMMAND"
                                mode="switch"
                                >
                                <PARAM
                                    name="0"
                                    help="Specifies an UNENCRYPTED authentication-key string will follow"
                                    ptype="SUBCOMMAND"
                                    mode="subcommand"
                                    yang_name="&NTP_CONFIG;/authentication-keys/authentication-key/encrypt=false"
                                    >
                                </PARAM>
                                <PARAM
                                    name="7"
                                    help="Specifies a HIDDEN authentication-key string will follow"
                                    ptype="SUBCOMMAND"
                                    mode="subcommand"
                                    yang_name="&NTP_CONFIG;/authentication-keys/authentication-key/encrypt=true"
                                    >
                                </PARAM>
                            </PARAM>
                            <PARAM
                                name="WORD"
                                help="Authentication key"
                                ptype="STRING"
                                yang_name="&NTP_CONFIG;/authentication-keys/authentication-key/key-val=${WORD}"
                                >
                            </PARAM>
                        </PARAM>
                    </PARAM>
                </PARAM>
                <PARAM
                    name="server"
                    help="Configure NTP server"
                    ptype="SUBCOMMAND"
                    mode="subcommand"
                    yang_key ="&NTP_CONFIG;/servers/server/address"
                    >
                    <PARAM
                        name="phost"
                        help="NTP server address or name"
                        ptype="STRING"
                        yang_name="&NTP_CONFIG;/servers/server/address=${phost}"
                        >
                        <PARAM
                            name="key"
                            help="Configure peer authentication key"
                            ptype="SUBCOMMAND"
                            mode="subcommand"
                            optional="true"
                            >
                            <PARAM
                                name="key_num"
                                help="Peer key number"
                                ptype="RANGE_1_4294967295"
                                yang_name="&NTP_CONFIG;/servers/server/key-id=${key_num}"
                                >
                            </PARAM>
                        </PARAM>
                        <PARAM
                            name="prefer"
                            help="Prefer this peer when possible"
                            ptype="SUBCOMMAND"
                            mode="subcommand"
                            optional="true"
                            yang_name="&NTP_CONFIG;/servers/server/prefer=true"
                            >
                        </PARAM>
                    </PARAM>
                </PARAM>
                <PARAM
                    name="master"
                    help="Enable local clock to act as server"
                    ptype="SUBCOMMAND"
					mode="subcommand"
					prompt_fn="set_ntp_master_default"
					yang_name="&NTP_CONFIG;/master"
					>
                    <PARAM
                        name="stratum_num"
                        help="Stratum (default = 8)"
                        ptype="RANGE_2_10"
						optional="true"
						yang_name="&NTP_CONFIG;/master/stratum=${stratum_num} "
                        >
                    </PARAM>
                </PARAM>
                <PARAM
                    name="source"
                    help="Configure interface for source address"
                    ptype="SUBCOMMAND"
                    mode="subcommand"
                    yang_name="&NTP_CONFIG;/source-iface"
                    >
                    <PARAM
                        name="interface_opt"
                        help="Specifies an Interface"
                        ptype="SUBCOMMAND"
                        mode="switch"
                        >
                        <PARAM
                            name="piface_name"
                            help="Physical interface"
                            ptype="PHY_INTERFACE"
                            yang_name="&NTP_CONFIG;/source-iface=${piface_name}"
                            >
                        </PARAM>						
                        <PARAM
                            name="poiface"
                            help="Port-channel identifier"
                            ptype="PO_INTERFACE"
                            yang_name="&NTP_CONFIG;/source-iface=${poiface}"
                            >
                        </PARAM>						
                        <PARAM
                            name="vliface"
                            help="Vlan identifier"
                            ptype="VLAN_INTERFACE"
                            yang_name="&NTP_CONFIG;/source-iface=${vliface}"
                            >
                        </PARAM>											
                        <PARAM
                            name="loiface"
                            help="Loopback interface identifier"
                            ptype="LOOPBACK_INTERFACE"
                            yang_name="&NTP_CONFIG;/source-iface=${loiface}"
                            >
                        </PARAM>																
                        <PARAM
                            name="mgiface"
                            help="Management interface"
                            ptype="MGMT_INTERFACE"
                            yang_name="&NTP_CONFIG;/source-iface=${mgiface}"
                            >
                        </PARAM>																					
                    </PARAM>
                </PARAM>
            </PARAM>
            <ACTION
                builtin="clish_extn"
                >
            </ACTION>
        </COMMAND>
        <COMMAND
            name="ntp trusted-key"
            help="Key numbers for trusted time sources"
            operation="edit-config"
            namespace="&NAME_SPACE;"
            yang_key="&NTP_CONFIG;/trusted-keys/trusted-key;;leaf-list"
            >
            <PARAM
                name="tkey_num"
                help="Key number"
                ptype="RANGE_1_4294967295"
                yang_name="&NTP_CONFIG;/trusted-keys/trusted-key=${tkey_num}"
                >
            </PARAM>
            <ACTION
                builtin="clish_extn"
                >
            </ACTION>
        </COMMAND>
        <COMMAND
            name="no ntp"
            help="Configure NTP"
            operation="edit-config"
            namespace="&NAME_SPACE;"
            >
            <PARAM
                name="ntp Options"
                help="Choose one option"
                ptype="SUBCOMMAND"
                mode="switch"
                >
                <PARAM
                    name="authenticate"
                    help="Authenticate time sources"
                    ptype="SUBCOMMAND"
                    mode="subcommand"
                    sub_oper_yang="remove:auth-enabled"
                    yang_name="&NTP_CONFIG;/auth-enabled"
                    >
                </PARAM>
                <PARAM
                    name="authentication-key"
                    help="Authentication key for trusted time sources"
                    ptype="SUBCOMMAND"
                    mode="subcommand"
                    >
                    <PARAM
                        name="pkey_num"
                        help="Key number"
                        ptype="RANGE_1_4294967295"
                        sub_oper_yang="remove:authentication-key"
                        yang_name="&NTP_CONFIG;/authentication-keys/authentication-key/key-id=${pkey_num}"
                        >
                    </PARAM>
                </PARAM>
                <PARAM
                    name="server"
                    help="Configure NTP server"
                    ptype="SUBCOMMAND"
                    mode="subcommand"
                    >
                    <PARAM
                        name="phost"
                        help="NTP server address or name"
                        ptype="STRING"
                        sub_oper_yang="remove:server"
                        yang_name="&NTP_CONFIG;/servers/server/address=${phost}"
                        >
                    </PARAM>
                </PARAM>
                <PARAM
                    name="master"
                    help="Enable local clock to act as server"
                    ptype="SUBCOMMAND"
                    mode="subcommand"
                    sub_oper_yang="remove:master"
                    yang_name="&NTP_CONFIG;/master"
                    >
                </PARAM>
                <PARAM
                    name="source"
                    help="Configure interface for source address"
                    ptype="SUBCOMMAND"
                    mode="subcommand"
                    sub_oper_yang="remove:source-iface"
                    yang_name="&NTP_CONFIG;/source-iface"
                    >
                </PARAM>
            </PARAM>
            <ACTION
                builtin="clish_extn"
                >
            </ACTION>
        </COMMAND>
        <COMMAND
            name="no ntp trusted-key"
            help="Key numbers for trusted time sources"
            operation="edit-config"
            namespace="&NAME_SPACE;"
            yang_key="&NTP_CONFIG;/trusted-keys/trusted-key;;leaf-list"
            >
            <PARAM
                name="tkey_num"
                help="Key number"
                ptype="RANGE_1_4294967295"
                sub_oper_yang="remove:trusted-key"
                yang_name="&NTP_CONFIG;/trusted-keys/trusted-key=${tkey_num}"
                >
            </PARAM>
            <ACTION
                builtin="clish_extn"
                >
            </ACTION>
        </COMMAND>
    </VIEW>
       <!--=================================================================-->
    <!-- ********************************************************************** -->
    <!-- *  INTERFACE COMMANDS                                            * -->
    <!-- *  View : interface-view                                             * -->
    <!-- ********************************************************************** -->
    <VIEW
        name="configure-if-view"
        >

        <COMMAND
            name="ntp"
            help="Configure NTP"
            operation="edit-config"
            namespace="&MODULE-INTF-NTP-NS;"
            yang_name="&INTF_NAME;"
            >
            <PARAM
                name="ntp Options"
                help="Choose one option"
                ptype="SUBCOMMAND"
                mode="switch"
                >
                <PARAM
                    name="disable"
                    help="Disable NTP on this interface"
                    ptype="SUBCOMMAND"
                    mode="subcommand"
                    yang_name="&INTF_ENTRY;/dell-ntp:ntp-interfaces/dell-ntp:disable=true"
                    >
                </PARAM>
                <PARAM
                    name="broadcast"
                    help="Configure NTP broadcast service"
                    ptype="SUBCOMMAND"
                    mode="subcommand">
                    <PARAM
                        name="client"
                        help="NTP broadcast client"
                        ptype="SUBCOMMAND"
                        mode="subcommand"
                        yang_name="&INTF_ENTRY;/dell-ntp:ntp-interfaces/dell-ntp:broadcast-client=true"
                        >
                    </PARAM>
                </PARAM>
                <PARAM
                    name="multicastcast"
                    help="Configure NTP multicast service"
                    pfeature="NOT_SUPPORTED"
                    ptype="SUBCOMMAND"
                    mode="subcommand"
                    >
                    <PARAM
                        name="client"
                        help="NTP multicastcast client"
                        ptype="SUBCOMMAND"
                        mode="subcommand"
                        yang_name="&NTP_CONFIG;/ntp-interfaces/ntp-interface/multicastcast-client=true"
                        >
                        <PARAM
                            name="Address"
                            help="Multicast group IP address"
                            ptype="IP_ADDR"
                            yang_name="&NTP_CONFIG;/ntp-interfaces/ntp-interface/multicastcast-addr=${Address}"
                            >
                        </PARAM>
                    </PARAM>
                </PARAM>
            </PARAM>
            <ACTION
                builtin="clish_extn"
                >
            </ACTION>
        </COMMAND>
        <COMMAND
            name="no ntp"
            help="Configure NTP"
            operation="edit-config"
            namespace="&MODULE-INTF-NTP-NS;"
            yang_name="&INTF_NAME;"
            >
            <PARAM
                name="ntp Options"
                help="Choose one option"
                ptype="SUBCOMMAND"
                mode="switch"
                >
                <PARAM
                    name="disable"
                    help="Disable NTP on this interface"
                    ptype="SUBCOMMAND"
                    mode="subcommand"
                    yang_name="&INTF_ENTRY;/dell-ntp:ntp-interfaces/dell-ntp:disable=false"
                    >
                </PARAM>
                <PARAM
                    name="broadcast"
                    help="Configure NTP broadcast service"
                    ptype="SUBCOMMAND"
                    mode="subcommand">
                    <PARAM
                        name="client"
                        help="NTP broadcast client"
                        ptype="SUBCOMMAND"
                        mode="subcommand"
                        yang_name="&INTF_ENTRY;/dell-ntp:ntp-interfaces/dell-ntp:broadcast-client=false"
                        >
                    </PARAM>
                </PARAM>
                <PARAM
                    name="multicastcast"
                    help="Configure NTP multicast service"
                    pfeature="NOT_SUPPORTED"
                    ptype="SUBCOMMAND"
                    mode="subcommand"
                    >
                    <PARAM
                        name="client"
                        help="NTP multicastcast client"
                        ptype="SUBCOMMAND"
                        mode="subcommand"
                        sub_oper_yang="remove:multicast-client"
                        yang_name="&NTP_CONFIG;/ntp-interfaces/ntp-interface/multicastcast-client=false"
                        >
                        <PARAM
                            name="Address"
                            help="Multicast group IP address"
                            ptype="STRING"
                            sub_oper_yang="remove:multicastcast-addr"
                            yang_name="&NTP_CONFIG;/ntp-interfaces/ntp-interface/multicastcast-addr=${Address}"
                            >
                        </PARAM>
                    </PARAM>
                </PARAM>
            </PARAM>
            <ACTION
                builtin="clish_extn"
                >
            </ACTION>
        </COMMAND>
    </VIEW>
    <!--=================================================================-->
    <!-- ********************************************************************** -->
    <!-- *  SHOW NTP COMMANDS                                                 * -->
    <!-- *  View : enable-view                                             * -->
    <!-- ********************************************************************** -->
    <VIEW name="enable-view">
        <COMMAND name="show ntp"
            help="NTP associations"
            operation="get"
            namespace="&NAME_SPACE;"
            >
            <PARAM name="associations"
                help="NTP associations"
                ptype="SUBCOMMAND"
                mode="subcommand">
            </PARAM>
            <ACTION builtin="clish_file_print"> ntpdc -c dmpeers</ACTION>
        </COMMAND>
        <COMMAND name="show ntp status"
            help="NTP status"
            operation="get"
            namespace="&NAME_SPACE;"
            >
            <ACTION builtin="clish_file_print"> ntpdc -c sysinfo</ACTION>
        </COMMAND>
    </VIEW>
</CLISH_MODULE>
